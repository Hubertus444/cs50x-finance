{% extends "layout.html" %}

{% block title %} Home {% endblock %}

{% block main %}
<link href="{{url_for('static', filename='css/addons/datatables.min.css')}}" rel="stylesheet"/>
<div class="row">
  {% if status: %}
  <div class="col-12">
    <div class="card bg-warning">
      <!-- {{result['status']}}  -->
      {{status['reason']}}
    </div>
  </div>
  {% endif %}
  <div class="col">
    <div class="row">
      <div class="col-2 card bg-primary" id="balance"></div>
      <div class="col-2 card bg-info pull-right" id="Tbalance"></div>
    </div>
  </div>

  <div class="col-12">
    <div class="title">
      <h3>User Stock(s)</h3>
    </div>
    <div class="table-responsive">
      <table id="user-stocks" class="table table-hover table-bordered nowrap">
        <thead class="bg-dark">
          <tr>
            <th><i class="icofont icofont-chart-flow-alt-2"></i></th>
            <th><i class="icofont icofont-coins"></i> Symbol</th>
            <th><i class="icofont icofont-deal"></i> Shares</th>
            <th><i class="icofont icofont-money-bag"></i> Current Price</th>
            <th><i class="icofont icofont-money-bag"></i> Total Price</th>
          </tr>
        </thead>
        <tbody>
          {% for stock in data['owned']: %}
          <tr>
            <td>1</td>
            <td>{{stock.stock}}</td>
            <td>{{stock.shares}}</td>
            <td>{{stock.curPrice}}</td>
            <td class="text-warning">{{stock.curPrice * stock.shares}}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="col-12">
    <div class="title">
      <h3>Transactions</h3>
    </div>
    <div class="table-responsive">
      <table id="stocks" class="table table-hover table-striped table-bordered nowrap">
        <thead class="bg-dark">
          <tr>
            <th><i class="icofont icofont-chart-flow-alt-2"></i></th>
            <th><i class="icofont icofont-coins"></i> Symbol</th>
            <th><i class="icofont icofont-deal"></i> Shares</th>
            <th><i class="icofont icofont-money-bag"></i> Current Price</th>
            <th><i class="icofont icofont-money-bag"></i> Bought Price</th>
            <th><i class="icofont icofont-deal"></i> Type</th>
          </tr>
        </thead>
        <tbody>
          {% for stock in data['stocks']: %}
          <tr>
            <td>1</td>
            <td>{{stock.stock}}</td>
            <td>{{stock.shares}}</td>
            <td>{{stock.curPrice}}</td>
            <td>{{stock.price}}</td>
            <td class="text-warning">{{stock.type}}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}

{% block js %}
<script type="text/javascript" src="{{url_for('static', filename='js/addons/datatables.min.js')}}"></script>
<script type="text/javascript">
  $(document).ready(() => {
    const balance = (balance, txt) => (`<h3>${txt}: <span class='text-warning'>${balance}</span></h3>`)
    $('#balance').html(balance("{{data['balance']}}", '<i class="icofont icofont-bank-alt"></i>'))
    $('#Tbalance').html(balance("{{data['stockBalance']}}", '<i class="icofont icofont-money-bag"></i> '))

    var stocks = $('#stocks').DataTable()
    var user_stocks = $('#user-stocks').DataTable()

  })
</script>
{% endblock %}
